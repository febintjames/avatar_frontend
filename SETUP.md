# Frontend Setup Instructions

## Quick Start

Follow these steps to get the UAE National Anthem Kiosk frontend running:

### 1. Install Dependencies

```bash
cd kiosk_ui
npm install
```

This will install:
- Next.js 16
- React 19
- Zustand (state management)
- Tailwind CSS 4
- TypeScript

### 2. Create Environment File

Create a file named `.env.local` in the `kiosk_ui` directory:

```bash
# On Windows (PowerShell)
echo "NEXT_PUBLIC_API_BASE_URL=http://localhost:8000" > .env.local

# On macOS/Linux
echo "NEXT_PUBLIC_API_BASE_URL=http://localhost:8000" > .env.local
```

Or manually create `.env.local` with this content:
```
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000
```

### 3. Ensure Backend is Running

The frontend requires the backend API to be running. In a separate terminal:

```bash
cd ../UAE_anthem
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

Verify backend is running by visiting: http://localhost:8000/healthz

### 4. Start Frontend

```bash
npm run dev
```

The frontend will be available at: http://localhost:3000

### 5. Test the Application

1. Open http://localhost:3000
2. Click "Start Experience"
3. Select an avatar (Male, Female, Boy, or Girl)
4. Allow camera permissions
5. Capture your photo
6. Answer the quiz questions
7. Wait for video processing
8. Review your video
9. Download via QR code

## Complete Workflow

### Terminal 1 - Backend
```bash
cd UAE_anthem
.venv\Scripts\activate  # Windows
# source .venv/bin/activate  # macOS/Linux
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

### Terminal 2 - Frontend
```bash
cd kiosk_ui
npm run dev
```

## Production Build

### Build

```bash
npm run build
```

### Run Production Server

```bash
npm run start
```

The production server runs on port 3000 by default.

### Environment for Production

Update `.env.local` with your production API URL:

```
NEXT_PUBLIC_API_BASE_URL=https://api.your-domain.com
```

## Troubleshooting

### Issue: TypeScript Errors

**Solution**: Make sure dependencies are installed:
```bash
npm install
```

Restart your editor's TypeScript server.

### Issue: Cannot Find Module Errors

**Solution**: Clear Next.js cache and reinstall:
```bash
Remove-Item -Recurse -Force .next
npm install
npm run dev
```

### Issue: Camera Not Working

**Solutions**:
- Use HTTPS in production (camera requires secure context)
- For development, localhost is allowed
- Check browser permissions for camera access
- Try Chrome or Edge (best support)

### Issue: API Connection Refused

**Solutions**:
- Ensure backend is running: http://localhost:8000/healthz
- Check `.env.local` has correct API URL
- Verify no firewall blocking port 8000
- Check CORS settings on backend (should allow all origins in dev)

### Issue: Video Not Loading

**Solutions**:
- Check backend console for processing errors
- Verify video is accessible at the returned URL
- Check browser console for network errors
- Ensure sufficient disk space on backend for video storage

### Issue: Build Fails

**Solution**: Check Node.js version:
```bash
node --version  # Should be 18.x or higher
```

Update if needed, then:
```bash
npm install
npm run build
```

## Browser Compatibility

Recommended browsers:
- Chrome 90+
- Edge 90+
- Firefox 88+
- Safari 14+

**Required Features**:
- MediaDevices API (camera access)
- Fetch API
- LocalStorage
- ES2020+ JavaScript

## File Structure After Setup

```
kiosk_ui/
â”œâ”€â”€ .env.local                   # â† YOU CREATE THIS
â”œâ”€â”€ .next/                       # â† Generated by npm run dev
â”œâ”€â”€ node_modules/                # â† Generated by npm install
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ BackgroundWrapper.tsx
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ kioskStore.ts
â”‚   â”œâ”€â”€ avatar-selection/
â”‚   â”œâ”€â”€ camera/
â”‚   â”œâ”€â”€ quiz/
â”‚   â”œâ”€â”€ processing/
â”‚   â”œâ”€â”€ review/
â”‚   â”œâ”€â”€ qr/
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## Development Tips

### Hot Reload

Next.js supports hot module replacement. Changes to files will auto-refresh the browser.

### Debug Mode

Open browser DevTools (F12) to see:
- Console logs for API calls
- Network tab for request/response
- Application tab for localStorage state

### State Inspection

Zustand state is persisted to localStorage as `kiosk-storage`. You can inspect it in DevTools â†’ Application â†’ Local Storage.

### Clear State

To reset the app state:
```javascript
// In browser console
localStorage.removeItem('kiosk-storage')
location.reload()
```

## Next Steps

Once the app is running:

1. **Test Complete Flow**: Go through the entire user journey
2. **Check API Integration**: Verify all endpoints are responding
3. **Test Camera**: Ensure camera works on target devices
4. **Test Quiz**: Verify questions load and scoring works
5. **Test Video**: Confirm videos generate and display correctly
6. **Test QR Code**: Verify QR codes generate and download works

## Getting Help

- **Frontend Issues**: Check [README.md](./README.md)
- **API Issues**: Check [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)
- **Backend Issues**: Check [../UAE_anthem/README.md](../UAE_anthem/README.md)
- **Workflow Questions**: Check [WORKFLOW_GUIDE.md](./WORKFLOW_GUIDE.md)

## Success Checklist

- [ ] Dependencies installed (`npm install`)
- [ ] `.env.local` created with API URL
- [ ] Backend running on port 8000
- [ ] Frontend running on port 3000
- [ ] Backend health check passes (http://localhost:8000/healthz)
- [ ] Landing page loads (http://localhost:3000)
- [ ] Camera permissions work
- [ ] API calls succeed (check browser console)
- [ ] Videos generate successfully
- [ ] QR codes display correctly

**Ready to test!** ğŸš€
